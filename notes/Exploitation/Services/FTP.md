# FTP

## Common Attacks

### Brute forcing with Medusa (example)

```bash
# single user
medusa -u fiona -P /usr/share/wordlists/rockyou.txt -h 10.129.203.7 -M ftp

# multi-user, custom port, threaded
medusa -U users.list -P passwords.list -h 10.129.203.6 -n 2121 -M ftp -t 10
```

### FTP Bounce (proxying scan through an FTP server)

```bash
# Use anonymous FTP as bounce to scan target host
nmap -Pn -v -n -p80 -b anonymous:password@10.10.110.213 172.17.0.2
```

## Enumeration & Tips

- Always check for anonymous login and list directories (`ftp`, `smbclient`, or `curl`/`wget` for HTTP-style listings).
- Try common alternative ports (e.g., 2121, 30021) if standard port 21 is closed.
- If you find user directories, grep for config/creds files and common filenames: `creds.txt`, `notes.txt`, `mynotes.txt`, `backup*.zip`.
- When FTP serves webroot directories (e.g., `C:\xampp\htdocs`), look for `test.php`, `docs.txt`, or webshell upload opportunities.

## Known Vulnerabilities

- CoreFTP Server Version 2.0 build 727 — CVE-2022-22836 (investigate exploitable paths and proof-of-concept availability).

## Example Workflow

1. `nmap -sV -p21,2121,30021 <target>`
2. Attempt anonymous login: `ftp <ip> <port>` → `anonymous` / `anonymous`
3. If files present, download and scan for plaintext credentials or hints.
4. If credentials found, attempt SSH/SMB/RDP with discovered usernames/passwords.
