# Simple Network Management Protocol (SNMP)

## Common Attack Paths

### Enumeration
- [ ] Default community strings → `snmpwalk -v2c -c public <target>`
- [ ] Brute-force community strings → `onesixtyone -c dict.txt <target>`
- [ ] Mass queries with Braa → `braa public@<target>:.1.3.6.*`
- [ ] Nmap NSE → `nmap --script='snmp* and not broadcast' -p161 <target>`
- [ ] Dump SNMP info → `snmpcheck -t <target> -c <community>`
- [ ] Faster walks on large trees → `snmpbulkwalk -v2c -c <community> -Cr100 <target> <OID>`

### Attack Paths
- Default strings (public/private) → system info disclosure
- Misconfigured access → dump routing tables, process lists, network configs, installed software
- SNMPv3 weak creds/misconfig → online guessing; capture & offline cracking possible depending on security level
- Disclosed network maps, creds, and service configs → pivot for lateral movement

### Auxiliary Notes
- SNMP v1/v2c are **plaintext**; v3 adds auth/privacy but is often misconfigured.
- Always try **UDP/161** first; some devices also answer on **TCP/161**.
- Vendor MIBs can reveal device-specific secrets (wireless keys, admin accounts, etc.).

---

## General Enumeration

*Common Commands*

`snmpwalk -v2c -c public <target>`

`onesixtyone -c /opt/useful/seclists/Discovery/SNMP/snmp.txt <target>`

`braa public@<target>:.1.3.6.*`

`snmpcheck -t <target> -c public`

---

## Enumeration Cheat-Sheet

### System & Host Facts

`snmpwalk -v2c -c <community> <target> 1.3.6.1.2.1.1`  
`snmpget  -v2c -c <community> <target> 1.3.6.1.2.1.1.5.0   # sysName`  
`snmpget  -v2c -c <community> <target> 1.3.6.1.2.1.1.1.0   # sysDescr`  
`snmpget  -v2c -c <community> <target> 1.3.6.1.2.1.1.6.0   # sysLocation`  

### Interfaces, IPs, ARP

`snmpwalk -v2c -c <community> <target> 1.3.6.1.2.1.2.2.1.2   # ifDescr`  
`snmpwalk -v2c -c <community> <target> 1.3.6.1.2.1.2.2.1.8   # ifOperStatus`  
`snmpwalk -v2c -c <community> <target> 1.3.6.1.2.1.4.20      # ipAddrTable`  
`snmpwalk -v2c -c <community> <target> 1.3.6.1.2.1.4.22      # ipNetToMedia (ARP)`  

### Routes & Neighbors

`snmpwalk -v2c -c <community> <target> 1.3.6.1.2.1.4.21      # ipRouteTable`  

(OSPF → `.1.3.6.1.2.1.14`, BGP → `.1.3.6.1.2.1.15` depending on device)

### Processes, Services, Software, Storage

`snmpwalk -v2c -c <community> <target> 1.3.6.1.2.1.25.1      # hrSystem`  
`snmpwalk -v2c -c <community> <target> 1.3.6.1.2.1.25.4.2.1.2  # hrSWRunName`  
`snmpwalk -v2c -c <community> <target> 1.3.6.1.2.1.25.4.2.1.4  # hrSWRunPath`  
`snmpwalk -v2c -c <community> <target> 1.3.6.1.2.1.25.6.3.1.2  # hrSWInstalledName`  
`snmpwalk -v2c -c <community> <target> 1.3.6.1.2.1.25.2.3.1.3  # hrStorageDescr`  
`snmpwalk -v2c -c <community> <target> 1.3.6.1.2.1.25.2.3.1.6  # hrStorageUsed`  

### Device & Vendor Details

`snmpwalk -v2c -c <community> <target> 1.3.6.1.4.1`  
`snmpwalk -v2c -c <community> <target> 1.3.6.1.4.1.9        # Cisco`  

### Nmap NSE

`nmap -sU -p161 --script snmp-info,snmp-interfaces,snmp-processes,snmp-netstat <target>`  
`nmap -sU -p161 --script snmp-brute --script-args snmp-brute.communitiesdb=/path/to/communities.txt <target>`  

### SNMPv3 Quick Tests

`snmpwalk -v3 -u <user> -l authNoPriv -a MD5 -A <authpass> <target> 1.3.6.1.2.1.1`  
`snmpwalk -v3 -u <user> -l authPriv  -a SHA -A <authpass> -x AES -X <privpass> <target> 1.3.6.1.2.1.1`  

---

## MIBs and OIDs

### MIB
- Text-based schema of SNMP objects, written in ASN.1.
- Define OIDs, access rights, types, descriptions.
- They describe **what** and **where** to query, not the data itself.

### OIDs
- Dot notation numeric paths (e.g. `.1.3.6.1.2.1.1.1.0`).
- Longer = more specific.
- Many nodes are “folders” for subtrees.

### Common OIDs
- `.1.3.6.1.2.1.1.1.0` → sysDescr  
- `.1.3.6.1.2.1.1.5.0` → sysName  
- `.1.3.6.1.2.1.1.6.0` → sysLocation  
- `.1.3.6.1.2.1.2.2.1.2` → ifDescr  
- `.1.3.6.1.2.1.4.20` → ipAddrTable  
- `.1.3.6.1.2.1.4.22` → ipNetToMedia  
- `.1.3.6.1.2.1.4.21` → ipRouteTable  
- `.1.3.6.1.2.1.25.4.2.1.2` → hrSWRunName  
- `.1.3.6.1.2.1.25.6.3.1.2` → hrSWInstalledName  
- `.1.3.6.1.2.1.25.2.3.1.6` → hrStorageUsed  

---

## Notes
- Save dumps: `snmpwalk -v2c -c <community> <target> > snmp_dump.txt`
- Use `snmpbulkwalk -Cr100` to reduce chatter on large dumps.
- Common communities: `public`, `private`, `cisco`, `admin`.
- Always check TCP/161 if UDP fails.
- Misconfigured SNMP often = **easy win** for recon and lateral movement.
