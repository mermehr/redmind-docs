# Pentest Field Cheat Sheet (Template)

## Legend

- **TARGET**: IP or host (e.g., `10.10.10.10`)
- **NET**: CIDR (e.g., `10.10.10.0/24`)
- **USER/PASS**: Username/Password
- **DOMAIN**: AD domain or DNS name
- **PORTS**: Comma list (e.g., `22,80,445`)
- **LHOST/LPORT**: Your callback IP/port
- **FILE**: Local or remote path
- **COMMUNITY**: SNMP community
- **DB**: Database name

---

## 0) Workflow Snippets
### Quick host up check
```bash
fping -a -g NET 2>/dev/null
```
### Save & reuse targets
```bash
export T=TARGET
echo $T >> targets.txt
```

---

## 1) Nmap (Core)
### Full TCP scan + safe scripts + versions
```bash
sudo nmap -sC -sV -p- -T4 TARGET -oA scans/TARGET_full
```
### Focused ports
```bash
nmap -sC -sV -p PORTS TARGET -oA scans/TARGET_pPORTS
```
### UDP top 100
```bash
sudo nmap -sU --top-ports 100 -sV TARGET -oA scans/TARGET_udp_top100
```
### Evasion tricks (examples)
```bash
sudo nmap -sS --source-port 53 --defeat-rst-ratelimit -T3 -p- TARGET
```

---

## 2) FTP
### Banner & list
```bash
nc -vn TARGET 21
ftp TARGET
```
### Mirror dir (anonymous or creds)
```bash
wget -m ftp://USER:PASS@TARGET:21/
```

---

## 3) SMB
### Enum
```bash
smbclient -L //TARGET/ -N
smbmap -H TARGET
enum4linux-ng -A TARGET
```
### Access share
```bash
smbclient //TARGET/SHARE -U USER
```

---

## 4) NFS
### Show exports & mount
```bash
showmount -e TARGET
sudo mount -t nfs TARGET:/EXPORT /mnt/nfs -o nolock
```

---

## 5) Mail: SMTP / IMAP / POP3
### SMTP (banner / VRFY if enabled)
```bash
nc -vn TARGET 25
openssl s_client -starttls smtp -connect TARGET:25
```
### IMAP (TLS + login + list + fetch)
```bash
openssl s_client -connect TARGET:993
a login USER PASS
a list "" "*"
a select INBOX
a fetch 1 BODY[TEXT]
```
### POP3 (TLS + USER/PASS + LIST + RETR)
```bash
openssl s_client -connect TARGET:995
USER USER
PASS PASS
LIST
RETR 1
```

---

## 6) DNS
### Basic
```bash
dig @TARGET DOMAIN any +nocmd +noall +answer
dig @TARGET axfr DOMAIN
```

---

## 7) SNMP
### Discover community & walk
```bash
onesixtyone -c /usr/share/seclists/Discovery/SNMP/snmp.txt TARGET
snmpwalk -v2c -c COMMUNITY TARGET 1.3.6.1.2.1 # mib-2
```
### Fast OID spray (read-only)
```bash
braa COMMUNITY@TARGET:.1.3.6.*
```

---

## 8) Databases
### MySQL / MariaDB (CLI)
```bash
mysql -h TARGET -u USER -p
# inside:
SHOW DATABASES;
USE DB;
SHOW TABLES;
SELECT * FROM table LIMIT 5;
```
### MySQL dump quick
```bash
mysqldump -h TARGET -u USER -p DB > dump.sql
```
### MSSQL (impacket)
```bash
mssqlclient.py USER:PASS@TARGET -windows-auth
# inside:
SELECT name FROM master..sysdatabases;
USE DB;
SELECT TOP 5 * FROM dbo.TableName;
```
### MSSQL with SQLCMD (Windows)
```bash
sqlcmd -S TARGET -U USER -P PASS -Q "SELECT @@version"
```

---

## 9) Web Quick Hits
```bash
whatweb TARGET
gobuster dir -u http://TARGET/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -k
curl -I http://TARGET/
```

---

## 10) SSH / Keys
### Try key auth
```bash
chmod 600 id_rsa
ssh USER@TARGET -i id_rsa
```
### Convert key formats
```bash
ssh-keygen -p -m PEM -f id_rsa
```

---

## 11) RDP
```bash
xfreerdp /u:USER /p:'PASS' /v:TARGET /dynamic-resolution +clipboard
```

---

## 12) Certificates & TLS
```bash
openssl s_client -connect TARGET:PORT -servername DOMAIN -tls1_2
openssl x509 -in cert.pem -text -noout
```

---

## 13) Windows Notes (cred harvest targets)
- `C:\Users\USER\AppData\Roaming\`
- Desktop notes / screenshots
- Saved RDP/SQL credentials
- Config files with `user=` `password=`

---

## 14) Add
- Tool:
```bash
# minimal flags you actually reuse
```
